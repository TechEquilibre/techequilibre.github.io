<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TechÉquilibre</title>
  <link rel="stylesheet" href="css/search.css">
</head>
<body>

<main>
  <h1>Bienvenue sur TechÉquilibre</h1>
  <p>
    TechÉquilibre vous aide à comprendre l’informatique simplement. Choisissez le bon système d’exploitation, adaptez votre matériel à vos vrais besoins et adoptez une approche responsable et durable du numérique.
  </p>
  <div class="note">
    <strong>Note :</strong> Toutes les recommandations de ce site sont <strong>indépendantes et non sponsorisées</strong>.
  </div>
</main>

<!-- JS RECHERCHE LOCALE -->
<script>
fetch('data/articles.json')
.then(res => res.json())
.then(data => {
  const inputs = document.querySelectorAll(".searchInput");

  function simpleMatch(str, query){
    str = str.toLowerCase(); query = query.toLowerCase();
    if(str.includes(query)) return true;
    let errors = 0;
    for(let i=0;i<Math.min(str.length,query.length);i++){
      if(str[i]!==query[i]) errors++;
      if(errors>1) return false;
    }
    return true;
  }

  function matchArticle(article, query){
    if(simpleMatch(article.title, query)) return true;
    if(simpleMatch(article.description, query)) return true;
    if(article.keywords){
      for(let kw of article.keywords){
        if(simpleMatch(kw, query)) return true;
      }
    }
    return false;
  }

  inputs.forEach(input=>{
    const suggestions = input.parentElement.querySelector(".suggestions");
    input.addEventListener("input", ()=>{
      const query = input.value.trim();
      suggestions.innerHTML='';
      if(query.length<2) return;

      const results = data.filter(a=>matchArticle(a, query));

      results.slice(0,5).forEach(article=>{
        const div = document.createElement("div");
        div.className="suggestion-item";
        div.innerHTML=`<a href="${article.url}"><strong>${article.title}</strong><br><small>${article.description}</small></a>`;
        suggestions.appendChild(div);
      });
    });
  });
})
.catch(err => console.error("Erreur chargement articles :", err));
</script>

</body>
</html>
